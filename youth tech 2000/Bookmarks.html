<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>My Bookmarks | Youth Tech 2000</title>
  <link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/main.min.css" rel="stylesheet"/>
  <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/main.min.js"></script>

  <style>
    body {
      font-family: "Poppins", sans-serif;
      background: #f8fafc;
      color: #333;
      margin: 0;
      padding: 0;
    }

    header {
      background: #4f46e5;
      color: white;
      padding: 1.5em;
      text-align: center;
    }

    header a {
      display: inline-block;
      margin-top: 1em;
      background: white;
      color: #4f46e5;
      padding: 0.5em 1em;
      border-radius: 6px;
      text-decoration: none;
      font-weight: 500;
    }

    main.container {
      max-width: 900px;
      margin: 2em auto;
      padding: 1em;
    }

    section.card {
      background: white;
      border-radius: 10px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      padding: 1.5em;
    }

    .section-title {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .muted {
      color: #666;
      font-size: 0.9em;
    }

    .bookmark-list {
      margin-top: 1em;
    }

    .bookmark-item {
      padding: 0.8em;
      border-bottom: 1px solid #eee;
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
    }

    .bookmark-item a {
      color: #4f46e5;
      text-decoration: none;
      font-weight: 500;
    }

    .bookmark-item button {
      background: #ef4444;
      color: white;
      border: none;
      padding: 0.3em 0.8em;
      border-radius: 4px;
      cursor: pointer;
    }

    .bookmark-item button:hover {
      background: #b91c1c;
    }

    .btn {
      padding: 0.6em 1em;
      border-radius: 6px;
      cursor: pointer;
      border: none;
      margin-top: 1em;
    }

    .btn-primary {
      background: #4f46e5;
      color: white;
    }

    .btn-ghost {
      background: transparent;
      color: #4f46e5;
      border: 1px solid #4f46e5;
    }

    .row {
      display: flex;
      gap: 0.5em;
      flex-wrap: wrap;
    }

    input, select {
      width: 100%;
      padding: 0.6em;
      border-radius: 5px;
      border: 1px solid #ccc;
      margin-top: 0.4em;
    }

    #qa-add-btn {
      background: #10b981;
      color: white;
      border: none;
      padding: 0.6em 1em;
      border-radius: 6px;
      cursor: pointer;
      margin-top: 0.8em;
    }

    #qa-add-btn:hover {
      background: #059669;
    }

  </style>
</head>

<body>
  <header>
    <h1>My Bookmarks</h1>
    <p class="lead">Saved bursaries, learnerships & internships ‚Äî plus quick links to study resources and bursary portals.</p>
    <a href="opportunities hub.html">‚Üê Back to Opportunities</a>
  </header>

  <main class="container">
    <section class="card">
      <div class="section-title">
        <h2>Saved Opportunities</h2>
        <span class="muted" id="count">0 saved</span>
      </div>

      <div id="bookmarkList" class="bookmark-list"></div>

      <button class="btn btn-primary" id="clearAllBtn">üóëÔ∏è Clear all saved</button>
      <button class="btn btn-ghost" id="exportBtn">‚¨áÔ∏è Export JSON</button>

      <div style="margin-top: 2em;">
        <h3>Add an Opportunity</h3>
        <form id="addForm">
          <input id="titleInput" placeholder="Title (e.g. iYouth ‚Äì Learnerships in Tech)" required />
          <div class="row">
            <input id="providerInput" placeholder="Provider (e.g. iYouth)" required />
            <input id="deadlineInput" placeholder="Deadline (e.g. 15 Nov 2025)" />
          </div>
          <input id="linkInput" placeholder="Link (https://...)" />
          <select id="typeInput" required>
            <option value="">Select Type</option>
            <option value="Bursary">Bursary</option>
            <option value="Learnership">Learnership</option>
            <option value="Internship">Internship</option>
            <option value="Other">Other</option>
          </select>
          <button id="qa-add-btn" type="submit">Add</button>
        </form>
      </div>
    </section>
  </main>

  <!-- FIREBASE SDK -->
  <script src="https://www.gstatic.com/firebasejs/10.5.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.5.0/firebase-firestore.js"></script>

  <script>
    /* ---------------- FIREBASE CONFIG ---------------- */
    const firebaseConfig = {
      apiKey: "YOUR_API_KEY",
      authDomain: "yourapp.firebaseapp.com",
      projectId: "yourapp",
      storageBucket: "yourapp.appspot.com",
      messagingSenderId: "YOUR_SENDER_ID",
      appId: "YOUR_APP_ID"
    };

    const app = firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    const bookmarkList = document.getElementById("bookmarkList");
    const count = document.getElementById("count");

    /* ---------------- FETCH BOOKMARKS ---------------- */
    function loadBookmarks() {
      db.collection("bookmarks").orderBy("createdAt", "desc").onSnapshot(snapshot => {
        bookmarkList.innerHTML = "";
        snapshot.forEach(doc => {
          const data = doc.data();
          const item = document.createElement("div");
          item.className = "bookmark-item";
          item.innerHTML = `
            <div>
              <strong>${data.title}</strong> <span class="muted">(${data.type})</span><br/>
              <small>Provider: ${data.provider} | Deadline: ${data.deadline || "N/A"}</small><br/>
              <a href="${data.link || "#"}" target="_blank">üîó View</a>
            </div>
            <button onclick="deleteBookmark('${doc.id}')">Remove</button>
          `;
          bookmarkList.appendChild(item);
        });
        count.innerText = `${snapshot.size} saved`;
      });
    }

    /* ---------------- ADD BOOKMARK ---------------- */
    document.getElementById("addForm").addEventListener("submit", async (e) => {
      e.preventDefault();
      const title = document.getElementById("titleInput").value;
      const provider = document.getElementById("providerInput").value;
      const deadline = document.getElementById("deadlineInput").value;
      const link = document.getElementById("linkInput").value;
      const type = document.getElementById("typeInput").value;

      await db.collection("bookmarks").add({
        title, provider, deadline, link, type,
        createdAt: firebase.firestore.FieldValue.serverTimestamp()
      });

      e.target.reset();
    });

    /* ---------------- DELETE SINGLE BOOKMARK ---------------- */
    async function deleteBookmark(id) {
      await db.collection("bookmarks").doc(id).delete();
    }

    /* ---------------- CLEAR ALL ---------------- */
    document.getElementById("clearAllBtn").addEventListener("click", async () => {
      const confirmClear = confirm("Are you sure you want to delete all saved bookmarks?");
      if (!confirmClear) return;

      const snapshot = await db.collection("bookmarks").get();
      const batch = db.batch();
      snapshot.forEach(doc => batch.delete(doc.ref));
      await batch.commit();
    });

    /* ---------------- EXPORT JSON ---------------- */
    document.getElementById("exportBtn").addEventListener("click", async () => {
      const snapshot = await db.collection("bookmarks").get();
      const data = snapshot.docs.map(doc => doc.data());
      const blob = new Blob([JSON.stringify(data, null, 2)], { type: "application/json" });
      const url = URL.createObjectURL(blob);

      const a = document.createElement("a");
      a.href = url;
      a.download = "bookmarks.json";
      a.click();
    });

    /* ---------------- INITIAL LOAD ---------------- */
    loadBookmarks();
  </script>
</body>
</html>